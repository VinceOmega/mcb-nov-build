<?php defined('SYSPATH') OR die('No direct access allowed.');class Products_packaging_Model extends ORM {		protected $belongs_to = array(		'product' => array(), 		'packaging' => array()	);		public function getProductsByPackaging ($packaging_id)	{		//get current product ids for packaging		$pps = $this->where('packaging_id',$packaging_id)->find_all();		$ppsProductsIds = array();		foreach ($pps as $pp)			$ppsProductsIds[] = $pp->product_id;				//get all products		$products = ORM::factory('product')->find_all();				return $this->_getCheckboxList('packagingProducts', $ppsProductsIds, $products);	}		public function getPackagingsByProduct ($product_id)	{		//get current packaging ids for product		$pps = $this->where('product_id',$product_id)->find_all();		$ppsPackagingsIds = array();		foreach ($pps as $pp)			$ppsPackagingsIds[] = $pp->packaging_id;				//get all packagings		$packagings = ORM::factory('packaging')->find_all();				return $this->_getCheckboxList('productPackagings', $ppsPackagingsIds, $packagings);	}		protected function _getCheckboxList ($checkboxName, $currentIds, $allItems)	{		$out = '<ul style="list-style-type:none; padding:0">';                foreach ($allItems as $item)        {            $check ='';            if (in_array($item->id,  $currentIds))                $check = 'checked=checked';                        $out .= '<li><label><input type="checkbox" value='.$item->id.' name="'.$checkboxName.'[]" '. $check.' />' . $item->name .'</label>(ID: '.$item->id.')</li>';        }		        $out .= '</ul>';        return $out;	}}